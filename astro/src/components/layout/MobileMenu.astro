---
import Button from '@components/common/Button.astro';
import { navItems } from '@lib/navigation';

const base = import.meta.env.BASE_URL;
---

<div class="mobile-menu" id="mobileMenu">
  <nav class="mobile-nav">
    <ul>
      {navItems.map((item) => (
        <li><a href={item.href}>{item.label}</a></li>
      ))}
    </ul>
    <div class="mobile-cta">
      <Button href="#join" variant="primary" full>Join the Crew</Button>
      <Button href={`${base}/publishers`} variant="ghost" full>Partner with us</Button>
    </div>
  </nav>
</div>

<script>
  const menuBtn = document.getElementById('mobileMenuBtn');
  const mobileMenu = document.getElementById('mobileMenu');
  const mobileLinks = mobileMenu?.querySelectorAll('a');
  
  function closeMenu() {
    menuBtn?.classList.remove('active');
    mobileMenu?.classList.remove('active');
    document.body.style.overflow = '';
  }
  
  menuBtn?.addEventListener('click', () => {
    menuBtn.classList.toggle('active');
    mobileMenu?.classList.toggle('active');
    document.body.style.overflow = mobileMenu?.classList.contains('active') ? 'hidden' : '';
  });
  
  // Close menu when clicking a link
  mobileLinks?.forEach(link => {
    link.addEventListener('click', closeMenu);
  });
  
  // Close menu on Escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && mobileMenu?.classList.contains('active')) {
      closeMenu();
    }
  });
</script>
